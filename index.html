<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AURA</title>
    <link rel="stylesheet" href="./frontend/css/home.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>

  <body>
    <!-- ========== HEADER (apenas 1x) ========== -->
    <header class="navbar">
      <div class="logo">AURA</div>

      <nav>
        <ul class="nav-links">
          <li><a href="#characters">Personagens</a></li>
          <li><a href="#sobre">Sobre</a></li>
          <li><a href="#ajuda">Contato/Ajuda</a></li>
          <li><a href="#app">App</a></li>
        </ul>
      </nav>

      <!-- √°rea de autentica√ß√£o alinhada √† direita -->
      <div class="auth-area">
        <!-- bot√£o de login (vis√≠vel quando deslogado) -->
        <a id="loginBtn" href="login.html" class="login-btn">Login</a>

        <!-- menu de perfil (vis√≠vel quando logado) -->
        <div id="profileMenu" class="profile-menu">
          <button
            id="profileBtn"
            class="profile-btn"
            aria-haspopup="true"
            aria-expanded="false"
          >
            <span id="userName">Usu√°rio</span>
            <i class="fa-solid fa-caret-down"></i>
          </button>

          <div id="dropdownMenu" class="dropdown" aria-hidden="true">
            <a href="perfil.html" id="alterarDados"
              ><i class="fa-solid fa-id-card"></i> Alterar Dados</a
            >
            <button id="logoutBtn" class="logout">
              <i class="fa-solid fa-right-from-bracket"></i> Sair
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Espa√ßo para mensagens (erro/sucesso) -->
    <div
      id="message"
      style="position: fixed; top: 90px; right: 20px; z-index: 9999"
    ></div>

    <!-- ====== RESTO DO SITE (igual ao seu) ====== -->
    <section class="hero">
      <div class="hero-content">
        <div class="text">
          <h1>AURA</h1>
          <h3>Aprendizagem com Uso de Realidade Aumentada</h3>
          <p>
            O AURA foi criado para tornar a aprendizagem mais divertida,
            acess√≠vel e inclusiva, usando personagens que trazem hist√≥rias e
            perspectivas √∫nicas. Assim, as crian√ßas aprendem com empatia.
          </p>
          <a href="#app" class="cta">Vamos come√ßar?</a>
        </div>

        <div class="image">
          <img src="./img/coruja.png" alt="Coruja AURA" />
        </div>
      </div>
      <img src="./img/nuvem.png" alt="Nuvem" class="cloud left" />
    </section>

    <section class="characters" id="characters">
      <h2 class="section-title">Nossos Personagens</h2>
      <p class="section-subtitle">Conhe√ßa os amigos do AURA</p>

      <div class="character nocti">
        <div class="character-text">
          <h3>Nocti</h3>
          <p>
            ‚ÄúFeche os olhos... escute. O que voc√™ ouve al√©m dos sons? Eu te
            ajudo a descobrir.‚Äù
          </p>
        </div>
        <div class="character-img">
          <img src="./img/coruja.png" alt="Nocti" />
          <img
            src="./img/nuvem.png"
            class="cloud decor"
            alt="Nuvem decorativa"
          />
        </div>
      </div>

      <div class="character mobi">
        <div class="character-img">
          <img src="./img/macaco.png" alt="Mobi" />
          <img
            src="./img/nuvem.png"
            class="cloud decor"
            alt="Nuvem decorativa"
          />
        </div>
        <div class="character-text">
          <h3>Mobi</h3>
          <p>O macaquinho curioso e aventureiro!</p>
        </div>
      </div>

      <div class="character elefante">
        <div class="character-text">
          <h3>Luno</h3>
          <p>
            Um elefante gentil que ensina a import√¢ncia da mem√≥ria e da amizade.
          </p>
        </div>
        <div class="character-img">
          <img src="./img/elefante.png" alt="Elefante Luno" />
          <img
            src="./img/nuvem.png"
            class="cloud decor"
            alt="Nuvem decorativa"
          />
        </div>
      </div>
    </section>

    <section class="sobre" id="sobre">
      <div class="sobre-container">
        <h1>Sobre N√≥s</h1>
        <p>
          Somos uma equipe dedicada a tornar a educa√ß√£o mais inclusiva e
          acess√≠vel por meio da tecnologia. O sistema AURA une um aplicativo
          m√≥vel e um dispositivo IoT, permitindo que crian√ßas aprendam de forma
          l√∫dica com cartas f√≠sicas interativas e minigames educativos. Nosso
          objetivo √© integrar aprendizado, divers√£o e inclus√£o, promovendo uma
          experi√™ncia que respeita o ritmo e as necessidades de cada crian√ßa.
        </p>
        <p>Nosso objetivo √© integrar aprendizado, divers√£o e inclus√£o...</p>
      </div>

      <div class="sobre-bottom">
        <div class="sobre-img-top">
          <img src="./img/amigos.png" alt="Personagens AURA assistindo TV" />
        </div>

        <!-- Bot√£o para abrir modal -->
        <div class="apk-button-container" id="app">
          <h1>AQUI E O LINK E O QRCODE PARA DOWLOWAD DO NOSSO APP</h1>
          <button id="openApkModal" class="apk-btn">Baixar App AURA</button>
        </div>

        <!-- Modal APK -->
        <div id="apkModal" class="modal">
          <div class="modal-content">
            <span id="closeModal" class="close-btn">&times;</span>

            <div class="modal-body">
              <div class="modal-left">
                <h3>Baixe o aplicativo AURA</h3>
                <p>Clique abaixo para baixar o APK diretamente:</p>
                <a
                  href="https://example.com/aura.apk"
                  class="download-link"
                  target="_blank"
                  >üì¶ Download do APK</a
                >
              </div>

              <div class="divider"></div>

              <div class="modal-right">
                <h3>Escaneie o QR Code</h3>
                <img
                  src="./img/qrcode.png"
                  alt="QR Code do app AURA"
                  class="qrcode-img"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="ajuda-contato" id="ajuda">
  <div class="ajuda-img">
    <img src="./img/friends.png" alt="Personagens AURA felizes" />
  </div>

  <div class="ajuda-texto">
    <h2>Ajuda & Contato</h2>
    <ul>
      <li>
        <a href="https://wa.me/5511930364625" target="_blank" rel="noopener noreferrer">
          <i class="fa-solid fa-phone"></i> +55 (11) 93036-4625
        </a>
      </li>
      <li>
        <a href="https://www.tiktok.com/@auraeduca" target="_blank" rel="noopener noreferrer">
          <i class="fa-brands fa-tiktok"></i> @auraeduca
        </a>
      </li>
      <li>
        <a href="https://x.com/auraeducacao" target="_blank" rel="noopener noreferrer">
          <i class="fa-brands fa-x-twitter"></i> @auraeduca
        </a>
      </li>
      <li>
        <a href="https://www.instagram.com/auraaprendizagem/" target="_blank" rel="noopener noreferrer">
          <i class="fa-brands fa-instagram"></i> @auraeduca
        </a>
      </li>
      <li>
        <a href="https://www.facebook.com/profile.php?id=61583683352640" target="_blank" rel="noopener noreferrer">
          <i class="fa-brands fa-facebook"></i> @auraeduca
        </a>
      </li>
    </ul>
  </div>
</div>
    </section>

    <!-- ========== SCRIPTS ==========
         NOTE A ORDEM: Firebase SDKs -> firebase.js -> outros scripts
    ================================== -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script src="./backend/firebase.js"></script>
    <script src="./frontend/js/animations.js"></script>

    <script>
  // ========== NOTIFICA√á√ÉO MODERNA ==========
  function showNotification(message, isSuccess = false) {
    const old = document.querySelector('.notification');
    if (old) old.remove();

    const notif = document.createElement('div');
    notif.className = `notification ${isSuccess ? 'success' : 'error'}`;
    const icon = isSuccess ? 'fa-check-circle' : 'fa-exclamation-circle';
    notif.innerHTML = `<i class="fa-solid ${icon}"></i> ${message}`;
    document.body.appendChild(notif);

    setTimeout(() => {
      notif.style.animation = 'fadeOut 0.5s forwards';
      setTimeout(() => notif.remove(), 500);
    }, 4000);
  }

  // ========== MODAL APK ==========
  const modal = document.getElementById("apkModal");
  const openBtn = document.getElementById("openApkModal");
  const closeBtn = document.getElementById("closeModal");

  // ========== MENU DE PERFIL ==========
  const profileBtn = document.getElementById("profileBtn");
  const dropdownMenu = document.getElementById("dropdownMenu");

  if (profileBtn && dropdownMenu) {
    let menuVisible = false;

    profileBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      menuVisible = !menuVisible;
      dropdownMenu.classList.toggle("show", menuVisible);
      profileBtn.setAttribute("aria-expanded", menuVisible);
    });

    document.addEventListener("click", (e) => {
      if (!profileBtn.contains(e.target) && !dropdownMenu.contains(e.target)) {
        menuVisible = false;
        dropdownMenu.classList.remove("show");
        profileBtn.setAttribute("aria-expanded", "false");
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        menuVisible = false;
        dropdownMenu.classList.remove("show");
        profileBtn.setAttribute("aria-expanded", "false");
      }
    });
  }

  // ========== CONTROLE DE LOGIN (VISIBILIDADE) ==========
  firebase.auth().onAuthStateChanged(async (user) => {
    const loginBtn = document.getElementById("loginBtn");
    const profileMenu = document.getElementById("profileMenu");

    if (user) {
      if (loginBtn) loginBtn.style.display = "none";
      if (profileMenu) profileMenu.style.display = "flex";

      // Carrega nome do usu√°rio
      const userDoc = await firebase.firestore().collection("users").doc(user.uid).get();
      const nameEl = document.getElementById("userName");
      if (nameEl && userDoc.exists) {
        nameEl.textContent = userDoc.data().name || user.email;
      }
    } else {
      if (loginBtn) loginBtn.style.display = "block";
      if (profileMenu) profileMenu.style.display = "none";
    }
  });

  // ========== LOGOUT ==========
  document.getElementById("logoutBtn")?.addEventListener("click", async () => {
    try {
      await firebase.auth().signOut();
      showNotification("Voc√™ saiu da conta.", false);
      setTimeout(() => window.location.href = "login.html", 1500);
    } catch (error) {
      showNotification("Erro ao sair.", false);
    }
  });

  // ========== MODAL APK ==========
  if (openBtn) {
    openBtn.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();

      firebase.auth().onAuthStateChanged((user) => {
        if (user) {
          modal.style.display = "flex";
        } else {
          if (confirm("Voc√™ precisa estar logado para baixar o app.\nDeseja fazer login agora?")) {
            window.location.href = "login.html";
          }
        }
      });
    });
  }

  if (closeBtn) {
    closeBtn.addEventListener("click", () => modal.style.display = "none");
  }

  window.addEventListener("click", (e) => {
    if (e.target === modal) modal.style.display = "none";
  });

  window.addEventListener("keydown", (e) => {
    if (e.key === "Escape") modal.style.display = "none";
  });

  // ========== ANIMA√á√ïES DE ROLAGEM ==========
  document.addEventListener("DOMContentLoaded", () => {
    const sobreSection = document.querySelector(".sobre");
    if (sobreSection) {
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              sobreSection.classList.add("show");
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.3 }
      );
      observer.observe(sobreSection);
    }

    // Destaque ao clicar em links de navega√ß√£o
    document.querySelectorAll('a[href^="#"]').forEach(link => {
      link.addEventListener("click", function (e) {
        const targetId = this.getAttribute("href").substring(1);
        const target = document.getElementById(targetId);

        if (target) {
          e.preventDefault();
          const headerOffset = 100;
          const elementPosition = target.getBoundingClientRect().top + window.scrollY;
          const offsetPosition = elementPosition - headerOffset;

          window.scrollTo({
            top: offsetPosition,
            behavior: "smooth"
          });

          document.querySelectorAll(".highlight").forEach(el =>
            el.classList.remove("highlight")
          );

          let elementToHighlight;
          if (targetId === "app") elementToHighlight = target.querySelector(".apk-btn");
          if (targetId === "ajuda") elementToHighlight = target.querySelector("h2");
          if (targetId === "sobre") elementToHighlight = target.querySelector("h1");

          if (elementToHighlight) {
            elementToHighlight.classList.add("highlight");
            setTimeout(() => elementToHighlight.classList.remove("highlight"), 1600);
          }
        }
      });
    });
  });
</script>

<!-- ========== CSS DA NOTIFICA√á√ÉO (para logout) ========== -->
<style>
  .notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 14px 20px;
    border-radius: 10px;
    color: white;
    font-weight: 500;
    font-size: 15px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 9999;
    display: flex;
    align-items: center;
    gap: 10px;
    animation: slideIn 0.3s ease, fadeOut 0.5s ease 3.5s forwards;
    max-width: 320px;
  }
  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  @keyframes fadeOut {
    to { opacity: 0; transform: translateX(100%); }
  }
  .notification.error { background: #d32f2f; }
  .notification.success { background: #2e7d32; }
  .notification i { font-size: 18px; }
</style>

    </script>
  </body>
</html>
